[General]
SyntaxVersion=2
BeginHotkey=32778
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=32775
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=57450cc6-1d33-4176-b8eb-ab1f62e263fe
Description=合成（5物品）
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=2
QUI=
[Relative]
SetupOCXFile=
[Comment]

[Attachment]
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


[Script]
UserVar FoX = 0 "X坐标"
UserVar FoY = 0 "Y坐标"
UserVar FoW = 1024 "W坐标"
UserVar FoH = 768 "H坐标"
UserVar FGS1 = DropList{"----------":1}=1 "------------"
UserVar FB_Mod = DropList{"使用以上数据作为游戏屏幕范围":1|"我啥都看不懂全屏吧":2}=1 "分辨率模式"
UserVar G_Ms = 1000 "延迟/毫秒"
UserVar Num = 20 "循环次数"
UserVar ItemNum = droplist{"3":3|"4":4|"5":5}= 3 "合成物品数"
UserVar ItemDelay = 3500 "物品识别延迟"
UserVar Sdelay = 100 "操作延迟"
If FB_Mod = 1 Then 
    SX = FoX
    SY = FoY
    SW = FoW
    SH = FoH
ElseIf FB_Mod = 2 Then
    SX = 0
    SY = 0
    SW = Plugin.Sys.GetScRX()
    SH = Plugin.Sys.GetScRY()
End If

PutAttachment "C:\3物品合成v1.0","temp.bmp"   

While 鼠标放在炉子上 = 0
    Delay 500
    var = GetCursorShape(1)
    If var = 1576667162 Then 
        SaveMousePos 
        LeftClick 1
        鼠标放在炉子上=1
    End If
Wend

Call Plugin.Msg.Tips("1")
Delay ItemDelay
/*Call Plugin.Msg.HideScrTXT()
Delay 30
Call Plugin.Msg.ShowScrTXT(0, 0, 1024, 768, "1号物品", "0000FF")*/
GetCursorPos x, y
//Call Plugin.Pic.PrintScreen(x-15, y-15, x, y, "C:\3物品合成v1.0\1.bmp")

Call Plugin.Msg.Tips("2")
Delay ItemDelay
/*Call Plugin.Msg.HideScrTXT()
Delay 30
Call Plugin.Msg.ShowScrTXT(0, 0, 1024, 768, "2号物品", "0000FF")*/
GetCursorPos x2, y2
//Call Plugin.Pic.PrintScreen(x2-15, y2-15, x, y, "C:\3物品合成v1.0\2.bmp")

Call Plugin.Msg.Tips("3")
Delay ItemDelay
/*Call Plugin.Msg.HideScrTXT()
Delay 30
Call Plugin.Msg.ShowScrTXT(0, 0, 1024, 768, "3号物品", "0000FF")*/
GetCursorPos x3, y3
//Call Plugin.Pic.PrintScreen(x3-15, y3-15, x, y, "C:\3物品合成v1.0\3.bmp")

If ItemNum >=4
    Call Plugin.Msg.Tips("4")
    Delay ItemDelay
    /*Call Plugin.Msg.HideScrTXT()
    Delay 30
    Call Plugin.Msg.ShowScrTXT(0, 0, 1024, 768, "4号物品", "0000FF")*/
    GetCursorPos x4, y4
End If

If ItemNum >=5
    Call Plugin.Msg.Tips("5")
    Delay ItemDelay
    /*Call Plugin.Msg.HideScrTXT()
    Delay 30
    Call Plugin.Msg.ShowScrTXT(0, 0, 1024, 768, "5号物品", "0000FF")*/

    GetCursorPos x5, y5
End If

FindPic SX,SY,SW,SH,"Attachment:\分解.bmp",1,fX,fY


For Num



    //FindPic SX,SY,SW,SH,"C:\3物品合成v1.0\1.bmp",1,intX,intY
    //If intX > SX And intY > SY Then 
    //    MoveTo intX + 10, intY + 10
    MoveTo x,y

    Delay Sdelay
    KeyDown "Shift", 1
    Delay Sdelay
    LeftClick 1
    Delay Sdelay
    KeyUp "Shift", 1
    Delay 500
    FindPic SX,SY,SW,SH,"Attachment:\分割窗口.bmp",0.7,intX,intY
    If intX > SX And intY > SY Then 
        Delay 300
        KeyPress "Enter", 1
        Goto item1
    End If
    LeftClick 1
    Rem item1
	
    MoveTo fx,fy - 40
    Delay 1000
    LeftClick 1

    //End If
    Delay 1000

    //FindPic SX,SY,SW,SH,"C:\3物品合成v1.0\2.bmp",1,intX,intY
    //If intX > SX And intY > SY Then 
    MoveTo x2,y2
    //    MoveTo intX + 10, intY + 10

    Delay Sdelay

    KeyDown "Shift", 1
    Delay Sdelay
    LeftClick 1
    Delay Sdelay
    KeyUp "Shift", 1
    Delay 500
    FindPic SX,SY,SW,SH,"Attachment:\分割窗口.bmp",0.7,intX,intY
    If intX > SX And intY > SY Then 
        Delay 300
        KeyPress "Enter", 1
        Goto item2
    End If
    LeftClick 1
    Rem item2
	
    MoveTo fx,fy - 100
    Delay 1000
    LeftClick 1

    //End If
    Delay 1000

    //FindPic SX,SY,SW,SH,"C:\3物品合成v1.0\3.bmp",1,intX,intY
    //If intX > SX And intY > SY Then 
    MoveTo x3,y3
    //    MoveTo intX + 10, intY + 10

    Delay Sdelay

    KeyDown "Shift", 1
    Delay Sdelay
    LeftClick 1
    Delay Sdelay
    KeyUp "Shift", 1
    Delay 500
    FindPic SX,SY,SW,SH,"Attachment:\分割窗口.bmp",0.7,intX,intY
    If intX > SX And intY > SY Then 
        Delay 300
        KeyPress "Enter", 1
        Goto item3
    End If
    LeftClick 1
    Rem item3
	
    MoveTo fx+60,fy - 40
    Delay 1000
    LeftClick 1


    If ItemNum >= 4 Then 
        MoveTo x4,y4
        //    MoveTo intX + 10, intY + 10

        Delay Sdelay

        KeyDown "Shift", 1
        Delay Sdelay
        LeftClick 1
        Delay Sdelay
        KeyUp "Shift", 1
        Delay 500
        FindPic SX,SY,SW,SH,"Attachment:\分割窗口.bmp",0.7,intX,intY
        If intX > SX And intY > SY Then 
            Delay 300
            KeyPress "Enter", 1
            Goto item4
        End If
        LeftClick 1
        Rem item4
	
        MoveTo fx+60,fy - 100
        Delay 1000
        LeftClick 1

    End If

    If ItemNum >= 5 Then 
        MoveTo x5,y5
        //    MoveTo intX + 10, intY + 10

        Delay Sdelay

        KeyDown "Shift", 1
        Delay Sdelay
        LeftClick 1
        Delay Sdelay
        KeyUp "Shift", 1
        Delay 500
        FindPic SX,SY,SW,SH,"Attachment:\分割窗口.bmp",0.7,intX,intY
        If intX > SX And intY > SY Then 
            Delay 300
            KeyPress "Enter", 1
            Goto item5
        End If
        LeftClick 1
        Rem item5
	
        MoveTo fx-60,fy - 100
        Delay 1000
        LeftClick 1

    End If











    //End If

    Delay 500

    MoveTo fx - 60, fy + 20
    Delay 500
    LeftClick 1

    Delay 7000
    RestoreMousePos 
    Delay 200

    LeftClick 1






Next
