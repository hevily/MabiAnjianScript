[General]
SyntaxVersion=2
BeginHotkey=32778
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=32775
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=183a29e1-0aba-4b96-ad05-6c95142134ee
Description=忍者集合
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=2
QUI=
[Relative]
SetupOCXFile=
[Comment]
隐身：4
束缚：6
烟幕：5

[Attachment]
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


[Script]
UserVar FGX = Droplist{"-------":1}=1 "--------"
UserVar FoX = 0 "X坐标"
UserVar FoY = 0 "Y坐标"
UserVar FoW = 1024 "W坐标"
UserVar FoH = 768 "H坐标"
UserVar FGX2 = Droplist{"-------":1}=1 "--------"
UserVar FB_Mod = Droplist{"使用上列数值":1|"上面看不懂 搜全屏吧":2}=2 "分辨率模式"
UserVar Mode = Droplist{"隐身":1|"束缚":2|"烟幕":3|"爆破":4|"获取机器码":9}=1 "模式"
UserVar MSX =dropList{"单点丢":1|"双点丢":2|"三点丢":3}=1 "烟幕模式"
UserVar YM_SK_D =1500 "烟幕延迟/ms"
UserVar BP_SK_D = 1300 "爆破延迟/ms"


If FB_Mod = 1 Then 
    SX = FoX
    SY = FoY
    SW = FoW
    SH = FoH
ElseIf FB_Mod = 2 Then
    SX = 0
    SY = 0
    SW = Plugin.Sys.GetScRX()
    SH = Plugin.Sys.GetScRY()
End If

SaveMousePos 

///////////////////////////////////////
//隐身
///////////////////////////////////////
If Mode = 1 Then 
    While Mode=1
        Call YS
        If YSCD = 1 Then 
            Delay 1000
            Call YS_Skill
        End If
    wend



End If

Sub YS_Skill
    Delay 500
    KeyPress "4", 1
    Delay 2000
    KeyPress "4", 1
    Delay 3000

End Sub
Sub YS
    FindPic SX,SY,SW,SH,"Attachment:\YS.bmp",1,intX,intY
    If intX > FoX And intY > FoY Then 
        YSCD = 1
    Else 
        YSCD = 0
    End If
End Sub
    
//////////////////////////////////////////
//束缚
//////////////////////////////////////////
If Mode = 2
    While Mode =2
        Call SF
        If SFCD = 1 Then 
            Call SFSkill
        End If
    wend
End If

Sub SFSkill
    KeyPress "6", 1
    RestoreMousePos
    LockMouse
    Delay 1200
    LeftClick 1
    UnlockMouse
End Sub

Sub SF
    FindPic SX,SY,SW,SH,"Attachment:\SF.bmp",1,intX,intY
    If intX > FoX And intY > FoY Then 
        SFCD = 1
    Else 
        SFCD = 0
    End If
End Sub

//////////////////////////////////
//烟幕
//////////////////////////////////
If Mode =3 Then
    If MSX = 3 Then 
        Call Plugin.Msg.Tips("1")
        Delay 2000
        GetCursorPos sbx, sby
        Delay 2000
        Call Plugin.Msg.Tips(sbx&sby)
        Delay 2000
        Call Plugin.Msg.Tips("2")
        Delay 2000
        GetCursorPos sbbx, sbby
        Delay 2000
        Call Plugin.Msg.Tips(sbbx&sbby)
        Delay 2000
        Call Plugin.Msg.Tips("3")
        Delay 2000
        GetCursorPos sbbbx, sbbby
        Delay 2000
        Call Plugin.Msg.Tips(sbbbx&sbbby)
        Delay 2000

        WH=0
        Rem TAgain
        Call YM
        If YMCD = 1 Then 
            Call Skill1
            Goto TAgain2
        End If
        Goto TAgain
        Rem TAgain2
        Call YM
        If YMCD = 1 Then 
            Call Skill2
            Goto TAgain3
        End If
        Goto TAgain2
        Rem TAgain3
        Call YM
        If YMCD = 1 Then 
            Call Skill3
            Goto TAgain
        End If
        Goto TAgain3
    End If

    If MSX = 2 Then 
        Call Plugin.Msg.Tips("1")
        Delay 2000
        GetCursorPos sbx, sby
        Delay 2000
        Call Plugin.Msg.Tips(sbx&sby)
        Delay 2000
        Call Plugin.Msg.Tips("2")
        Delay 2000
        GetCursorPos sbbx, sbby
        Delay 2000
        Call Plugin.Msg.Tips(sbbx&sbby)
        Delay 2000

        WH=0
        Rem SAgain
        Call YM
        If YMCD = 1 Then 
            Call Skill1
            Goto SAgain2
        End If
        Goto SAgain
        Rem SAgain2
        Call YM
        If YMCD = 1 Then 
            Call Skill2
            Goto SAgain
        End If
        Goto SAgain2
    End If


    If MSX = 1 Then 
        Call Plugin.Msg.Tips("1")
        Delay 2000
        GetCursorPos sbx, sby
        Delay 2000
        Call Plugin.Msg.Tips(sbx&sby)
        Delay 2000
    
        WH=0
        Rem Again
        Call YM
        If YMCD = 1 Then 
            Call Skill1
            Goto Again
        End If
        Goto Again
    End If
End If
Sub Skill1
    Delay YM_SK_D/2
    KeyPress "5", 1
    MoveTo sbx,sby
    LockMouse
    Delay YM_SK_D
    LeftClick 1
    UnlockMouse 
    Delay 700

End Sub
Sub Skill2
    Delay YM_SK_D/2
    KeyPress "5", 1
    MoveTo sbbx,sbby
    LockMouse
    Delay YM_SK_D
    LeftClick 1
    UnlockMouse 
    Delay 700

End Sub
Sub Skill3
    Delay YM_SK_D/2
    KeyPress "5", 1
    MoveTo sbbbx,sbbby
    LockMouse
    Delay YM_SK_D
    LeftClick 1
    UnlockMouse 
    Delay 700

End Sub

Sub YM
    FindPic SX,SY,SW,SH,"Attachment:\YM.bmp",1,intX,intY
    If intX > FoX And intY > FoY Then 
        YMCD = 1
    Else 
        YMCD = 0
    End If
End Sub

////////////////////////////////////
//爆破
////////////////////////////////////
While Mode=4 
    Rem RFOR
    Call BP
    If BPCD = 1 Then 
        RestoreMousePos 
        KeyPress "3", 1
        Delay 100
        LockMouse
        Delay BP_SK_D
        LeftClick 1
        UnlockMouse
    End If
wend

Sub BP
    FindPic SX,SY,SW,SH,"Attachment:\BP.bmp",1,intX,intY
    If intX > FoX And intY > FoY Then 
        BPCD = 1
    Else 
        BPCD=0
    End If
End Sub
